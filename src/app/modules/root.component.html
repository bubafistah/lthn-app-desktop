<ngx-section
        *ngIf="!hasCLI"
        class="shadow"
        [sectionTitle]="'words.states.not_installed' | translate"
        [sectionCollapsible]="false"
>
    <p *ngIf="!downloadingCLI">{{ 'words.states.not_installed_desc' | translate }}</p>
    <p *ngIf="downloadingCLI">{{ 'words.states.installing_desc' | translate }}</p>
    <ngx-button *ngIf="!downloadingCLI" (click)="downloadCLI()">{{ 'plugin.lthn.chain.words.install-blockchain' | translate }}</ngx-button>
    <ngx-progress-spinner
            *ngIf="downloadingCLI"
            appearance="icon"
    ></ngx-progress-spinner>
</ngx-section>


<ngx-section
        *ngIf="hasCLI"
        class="shadow"
        [sectionTitle]="'plugin.lthn.chain.table.title.chain-status' | translate"
        [sectionCollapsible]="false">

        <ngx-card-section *ngIf="chainInfo | ngrxPush as info">
            <div *ngIf="info.height" fxLayout="column, wrap" fxLayoutGap="18px">
                <div fxFlex="30" fxLayout="row" fxLayoutAlign="space-between">
                    <h5>{{'plugin.lthn.chain.words.height' | translate }}</h5>
                    <div class="lthn-brand"> {{info.height | number }} </div>
                </div>
                <div fxFlex="30" fxLayout="row" fxLayoutAlign="space-between">
                    <h5>{{'plugin.lthn.chain.words.tx_pool' | translate }}</h5>
                    <div class="lthn-brand"> {{info.tx_pool_size }} </div>
                </div>
                <div fxFlex="30" fxLayout="row" fxLayoutAlign="space-between">
                    <h5>{{'plugin.lthn.chain.words.alt_blocks' | translate }}</h5>
                    <div class="lthn-brand"> {{info.alt_blocks_count }} </div>
                </div>
                <div fxFlex="30" fxLayout="row" fxLayoutAlign="space-between">
                    <h5>{{'plugin.lthn.chain.words.difficulty' | translate }}</h5>
                    <div class="lthn-brand"> {{info.difficulty | number }} </div>
                </div>
                <div fxFlex="30" fxLayout="row" fxLayoutAlign="space-between">
                    <h5>{{'plugin.lthn.chain.words.grey_peerlist_size' | translate }}</h5>
                    <div class="lthn-brand"> {{info.grey_peerlist_size }} </div>
                </div>
                <div fxFlex="30" fxLayout="row" fxLayoutAlign="space-between">
                    <h5>{{'plugin.lthn.chain.words.incoming_connections_count' | translate }}</h5>
                    <div class="lthn-brand"> {{info.incoming_connections_count }} </div>
                </div>
                <div fxFlex="30" fxLayout="row" fxLayoutAlign="space-between">
                    <h5>{{'plugin.lthn.chain.words.outgoing_connections_count' | translate }}</h5>
                    <div class="lthn-brand"> {{info.outgoing_connections_count }} </div>
                </div>
                <div fxFlex="30" fxLayout="row" fxLayoutAlign="space-between">
                    <h5>{{'plugin.lthn.chain.words.status' | translate }}</h5>
                    <div class="lthn-brand"> {{info.status }} </div>
                </div>
                <div fxFlex="30" fxLayout="row" fxLayoutAlign="space-between">
                    <h5>{{'plugin.lthn.chain.words.target' | translate }}</h5>
                    <div class="lthn-brand"> {{info.target }} </div>
                </div>
                <div fxFlex="30" fxLayout="row" fxLayoutAlign="space-between">
                    <h5>{{'plugin.lthn.chain.words.target_height' | translate }}:</h5>
                    <div class="lthn-brand"> {{info.target_height | number}} </div>
                </div>
                <div fxFlex="30" fxLayout="row" fxLayoutAlign="space-between">
                    <h5>{{'plugin.lthn.chain.words.testnet' | translate }}</h5>
                    <div class="lthn-brand"> {{info.testnet }} </div>
                </div>

                <div fxFlex="30" fxLayout="row" fxLayoutAlign="space-between">
                    <h5>{{'plugin.lthn.chain.words.tx_count' | translate }}</h5>
                    <div class="lthn-brand"> {{info.tx_count | number }} </div>
                </div>
                <div fxFlex="30" fxLayout="row" fxLayoutAlign="space-between">
                    <h5>{{'plugin.lthn.chain.words.white_peerlist_size' | translate }}</h5>
                    <div class="lthn-brand"> {{info.white_peerlist_size }} </div>
                </div>
                <div fxFlex="40" fxLayout="row" fxLayoutAlign="space-between">
                    <h5>{{'plugin.lthn.chain.words.top_block_hash' | translate }}</h5>
                    <div [innerHTML]="info.top_block_hash | hashLink | keepHtml"></div>
                </div>
            </div>
            <div *ngIf="!info.height" fxLayout="column, wrap" fxLayoutGap="18px">
                <div fxFlex="30" fxLayout="row" fxLayoutAlign="space-between">
                    <h5>{{'plugin.lthn.chain.words.height' | translate }}</h5>
                    <ngx-card-placeholder></ngx-card-placeholder>
                </div>
                <div fxFlex="30" fxLayout="row" fxLayoutAlign="space-between">
                    <h5>{{'plugin.lthn.chain.words.tx_pool' | translate }}</h5>
                    <ngx-card-placeholder></ngx-card-placeholder>
                </div>
                <div fxFlex="30" fxLayout="row" fxLayoutAlign="space-between">
                    <h5>{{'plugin.lthn.chain.words.alt_blocks' | translate }}</h5>
                    <ngx-card-placeholder></ngx-card-placeholder>
                </div>
                <div fxFlex="30" fxLayout="row" fxLayoutAlign="space-between">
                    <h5>{{'plugin.lthn.chain.words.difficulty' | translate }}</h5>
                    <ngx-card-placeholder></ngx-card-placeholder>
                </div>
                <div fxFlex="30" fxLayout="row" fxLayoutAlign="space-between">
                    <h5>{{'plugin.lthn.chain.words.grey_peerlist_size' | translate }}</h5>
                    <ngx-card-placeholder></ngx-card-placeholder>
                </div>
                <div fxFlex="30" fxLayout="row" fxLayoutAlign="space-between">
                    <h5>{{'plugin.lthn.chain.words.incoming_connections_count' | translate }}</h5>
                    <ngx-card-placeholder></ngx-card-placeholder>
                </div>
                <div fxFlex="30" fxLayout="row" fxLayoutAlign="space-between">
                    <h5>{{'plugin.lthn.chain.words.outgoing_connections_count' | translate }}</h5>
                    <ngx-card-placeholder></ngx-card-placeholder>
                </div>
                <div fxFlex="30" fxLayout="row" fxLayoutAlign="space-between">
                    <h5>{{'plugin.lthn.chain.words.status' | translate }}</h5>
                    <ngx-card-placeholder></ngx-card-placeholder>
                </div>
                <div fxFlex="30" fxLayout="row" fxLayoutAlign="space-between">
                    <h5>{{'plugin.lthn.chain.words.target' | translate }}</h5>
                    <ngx-card-placeholder></ngx-card-placeholder>
                </div>
                <div fxFlex="30" fxLayout="row" fxLayoutAlign="space-between">
                    <h5>{{'plugin.lthn.chain.words.target_height' | translate }}:</h5>
                    <ngx-card-placeholder></ngx-card-placeholder>
                </div>
                <div fxFlex="30" fxLayout="row" fxLayoutAlign="space-between">
                    <h5>{{'plugin.lthn.chain.words.testnet' | translate }}</h5>
                    <ngx-card-placeholder></ngx-card-placeholder>
                </div>

                <div fxFlex="30" fxLayout="row" fxLayoutAlign="space-between">
                    <h5>{{'plugin.lthn.chain.words.tx_count' | translate }}</h5>
                    <ngx-card-placeholder></ngx-card-placeholder>
                </div>
                <div fxFlex="30" fxLayout="row" fxLayoutAlign="space-between">
                    <h5>{{'plugin.lthn.chain.words.white_peerlist_size' | translate }}</h5>
                    <ngx-card-placeholder></ngx-card-placeholder>
                </div>
                <div fxFlex="40" fxLayout="row" fxLayoutAlign="space-between">
                    <h5>{{'plugin.lthn.chain.words.top_block_hash' | translate }}</h5>
                    <ngx-card-placeholder></ngx-card-placeholder>
                </div>
            </div>
        </ngx-card-section>

    </ngx-section>

<ngx-section
        *ngIf="hasCLI"
        class="shadow"
        [sectionTitle]="'plugin.lthn.chain.table.title.recent-blocks' | translate"
        [sectionCollapsible]="false">
            <ngx-datatable
                    class="shadow"
                    [rows]="(blocks | ngrxPush)?.headers"
                    [loadingIndicator]="true"
                    [columnMode]="ColumnMode.force"
                    [headerHeight]="30"
                    [rowHeight]="25"
                    [trackByProp]="'timestamp'"
                    [sorts]="[{ prop: 'timestamp', dir: 'desc' }]"
            >
                <ngx-datatable-column prop="height"
                                      name="{{ 'plugin.lthn.chain.table.th.height' | translate }}"></ngx-datatable-column>
                <ngx-datatable-column prop="difficulty"
                                      name="{{ 'plugin.lthn.chain.table.th.difficulty' | translate }}">
                    <ng-template let-value="value" ngx-datatable-cell-template>
                        {{ value | hashrate:true}}
                    </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column prop="hash" name="{{ 'plugin.lthn.chain.table.th.hash' | translate }}">
                    <ng-template let-value="value" ngx-datatable-cell-template>
                        <span [innerHTML]="value | hashLink:'txn' | keepHtml"></span>
                    </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column prop="orphan_status"
                                      name="{{ 'plugin.lthn.chain.table.th.orphan_status' | translate }}">
                    <ng-template let-value="value" ngx-datatable-cell-template>
                        <mat-icon style="color: green" *ngIf="!value">done</mat-icon>
                        <mat-icon style="color: red" *ngIf="value">close</mat-icon>
                    </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column prop="reward" name="{{ 'plugin.lthn.chain.table.th.reward' | translate }}">
                    <ng-template let-value="value" ngx-datatable-cell-template>
                        {{ value | toCoin | number:'1.0-8'}}
                    </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column prop="timestamp" name="{{ 'plugin.lthn.chain.table.th.timestamp' | translate }}">
                    <ng-template let-value="value" ngx-datatable-cell-template>
                        {{ value | timeAgo }}
                    </ng-template>
                </ngx-datatable-column>
            </ngx-datatable>
    </ngx-section>





